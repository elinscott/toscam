!=========================================================!
! Input for calculation with the ONETEP program           !
!                                                         !
! Quality Control file for:                               ! 
! Implicit solvent (with a fixed cavity) for a charged    !
! species, smeared ions and the open-BC real-space local  !
! pseudopotential.                                        !
! The test case is the pyruvate ion.                      !
!                                                         !
! Created by J. Dziedzic on 01/11/2010                    !
!                                                         !
! School of Chemistry                                     !
! University of Southampton                               !
! Highfield                                               !
! Southampton SO17 1BJ                                    ! 
! UK                                                      !
!                                                         !
!=========================================================!


 ! This test uses a fixed dielectric cavity constructed
 ! from the initial-guess electronic density. Furthermore,
 ! only two NGWF iterations are performed. For these reasons
 ! the obtained total energy is not very meaningful.
 ! This is a Quality Control test, not a production calculation.

 print_qc T
 output_detail VERBOSE
 timings_level 0
 write_denskern F
 write_tightbox_ngwfs F

 charge -1

 ngwf_threshold_orig : 0.000002
 kernel_cutoff : 1000
 elec_cg_max 0
 occ_mix 1.0
 xc_functional PBE

 ! Turns on solvation
 is_implicit_solvent T
 is_include_cavitation T
 is_smeared_ion_rep T

 ! Parameters of the implicit solvent model 
 is_solvent_surface_tension 0.0000133859 ha/bohr**2
 is_solvation_beta 1.3
 is_density_threshold 0.00035
 is_bulk_permittivity 78.54
 is_dielectric_model fix_initial

 ! Numerical details
 is_multigrid_nlevels 4
 is_smeared_ion_width 0.8
 is_discretization_order 10
 is_bc_coarseness 3
 is_bc_surface_coarseness 1
 
 ! These will make the run reasonably short
 maxit_pen 0
 maxit_ngwf_cg 2
 minit_lnv 3
 maxit_lnv 3

 do_properties F

 psinc_spacing 0.5 0.5 0.5

 %block lattice_cart
  40.5000000   0.0000000   0.0000000
   0.0000000  40.5000000   0.0000000
   0.0000000   0.0000000  40.5000000
 %endblock lattice_cart

 %block positions_abs
C      23.03212536    21.66547677    20.00001701
C      21.21530414    19.39991534    19.99999055
C      18.30446146    20.20728603    20.00000000
O      18.03152442    22.57149309    19.99997732
O      16.77526612    18.41220612    20.00002457
O      21.99513395    17.22431247    19.99998110
H      24.99873199    20.99609204    19.99994520
H      22.63731984    22.85181140    21.65462596
H      22.63721023    22.85193423    18.34552711
 %endblock positions_abs

%block species
 H   H   1 1 7.0
 C   C   6 4 7.0
 O   O   8 4 7.0
%endblock species

%block species_pot
 H   "../../pseudo/hydrogen.recpot"
 C   "../../pseudo/carbon.recpot"
 O   "../../pseudo/oxygen.recpot"
%endblock species_pot
